name: CI
  
on:
  push:

jobs:
  build:
    name: Build
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: pnpm/action-setup@v3
      - uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: 'pnpm'
      - run: pnpm install

      - name: Build
        run: pnpm build
  
  test:
    name: Test Unit
    needs: build
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: pnpm/action-setup@v3
      - uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: 'pnpm'
      - run: pnpm install

      - name: Test
        run: echo "Test done"
    
  # deploy-develop:
  #   if: ${{ github.event.pull_request.base.ref == 'develop' }}
  #   name: Deploy Develop
  #   needs: test
  #   environment:
  #     name: develop
  #     url: https://develop.example.com
  #   runs-on: ubuntu-latest
  #   strategy:
  #     matrix:
  #       packages: [backend, web, helper-web, service]
  #   steps:
  #     - name: Checkout
  #       uses: actions/checkout@v2
  #     - name: Deploy
  #       run:
  #         sleep 30s && echo "${{ matrix.packages }} deploy done"
  
  # deploy-staging:
  #   if: ${{ github.event.pull_request.base.ref == 'main' }}
  #   name: Deploy Staging
  #   needs: test
  #   environment:
  #     name: staging
  #     url: https://staging.example.com
  #   runs-on: ubuntu-latest
  #   strategy:
  #     matrix:
  #       packages: [backend, web, helper-web, service]
  #   steps:
  #     - name: Checkout
  #       uses: actions/checkout@v2
  #     - name: Deploy
  #       run:
  #         sleep 30s && echo "${{ matrix.packages }} deploy done"
  
        
            
    